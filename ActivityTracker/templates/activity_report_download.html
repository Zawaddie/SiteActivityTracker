{% extends 'basedash.html' %}
{% load static %}
{% block content %}
<div class="container-fluid">
    <div class="col-md-12">
        <div class="text-center mb-4">
            <h2>Activities Report</h2>
            <p><strong>Report Generated By:</strong> {{ user.get_full_name }}</p>
            <img src="{% static 'images/LOGO.png' %}" alt="Company Logo" class="img-fluid" style="max-height: 110px;">
        </div>
        <hr>
        {% if activities %}
        <div class="report mt-4">
        <div class="row">
            <div class="col-md-12"> <h3><strong>TITLE: </strong>{{ site_name.upper }}</h3></div>
        </div>
            <hr>
        <div class="row">
            <div class="col-md-4"> <strong>PREPARED BY:</strong><h4>{{ user.get_full_name.upper }}</h4></div>
            <div class="col-md-4"> <strong>DATE: </strong><h4> {% now "d-m-Y" %}</h4></div>
            <div class="col-md-4"> <strong>TIME: </strong><h4>{% now "H:i:s" %}</h4></div>
        </div>
            <hr>
            <hr>
            {% for activity in activities %}
                {% if activity.site_name == site_name %}
                <p><strong>Date:</strong> {{ activity.date }}</p>
                <p><strong>Site Open Time:</strong> {{ activity.site_open_time }}</p>
                <p><strong>Site Close Time:</strong> {{ activity.site_close_time }}</p>
                <p><strong>Work Completed:</strong> {{ activity.work_completed }}</p>
                <p><strong>Equipment Used:</strong> {{ activity.equipment_used }}</p>
                <p><strong>Materials Used:</strong> {{ activity.materials_used }}</p>
                <div class="row">
                 <p class="text-center mt-4"><strong>Progress Photos:</strong></p>
                    {% for photo in activity.progress_photos.all %}
                    <div class="col-md-2">
                        <img src="{{ photo.image.url }}" alt="Progress Photo" width="190" height="190" class="mt-2">
                    </div>
                {% endfor %}
                </div>
                <div class="row">
                <p class="text-center mt-4"><strong>Documents Used:</strong></p>
                {% for document in activity.relevant_documents.all %}
                    <div class="col-md-2">
                    <a href="{{ document.document.url }}" style="color: black">Document Link</a>
                    </div>
                {% endfor %}
                </div>
                <hr>
                {% endif %}
            {% endfor %}
        </div>
{#            <button class="btn btn-success mt-2"><a href="{% url 'stk' %}" class="nav-link">Download PDF Report</a></button>#}
            <a href="{% url 'activityreportdownload' activity_in_report.id %}" class="btn btn-success mt-2">Download PDF Report</a>
        {% endif %}
    </div>
</div>
{% endblock %}